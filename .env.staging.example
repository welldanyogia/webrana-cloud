# ═══════════════════════════════════════════════════════════════════════════════
# WeBrana Cloud - Staging Environment Configuration
# 
# USAGE:
# 1. Copy this file to .env: cp .env.staging.example .env
# 2. Update secrets with actual staging values
# 3. Run: docker-compose -f docker-compose.staging.yml up -d
# ═══════════════════════════════════════════════════════════════════════════════

# ─────────────────────────────────────────────────────────────────────────────
# General Environment Settings
# ─────────────────────────────────────────────────────────────────────────────
NODE_ENV=staging
DEBUG=true
LOG_LEVEL=debug
SENTRY_ENV=staging

# ─────────────────────────────────────────────────────────────────────────────
# Database (PostgreSQL)
# ─────────────────────────────────────────────────────────────────────────────
# Host 'postgres-staging' matches the service name in docker-compose.staging.yml
DATABASE_HOST=postgres-staging
DATABASE_PORT=5432
DATABASE_USER=postgres
DATABASE_PASSWORD=postgres_staging_pass
DATABASE_NAME=webrana_staging

# Service-specific connection strings (using schemas for isolation)
DATABASE_URL_AUTH=postgresql://${DATABASE_USER}:${DATABASE_PASSWORD}@${DATABASE_HOST}:${DATABASE_PORT}/${DATABASE_NAME}?schema=auth
DATABASE_URL_CATALOG=postgresql://${DATABASE_USER}:${DATABASE_PASSWORD}@${DATABASE_HOST}:${DATABASE_PORT}/${DATABASE_NAME}?schema=catalog
DATABASE_URL_ORDER=postgresql://${DATABASE_USER}:${DATABASE_PASSWORD}@${DATABASE_HOST}:${DATABASE_PORT}/${DATABASE_NAME}?schema=order
DATABASE_URL_BILLING=postgresql://${DATABASE_USER}:${DATABASE_PASSWORD}@${DATABASE_HOST}:${DATABASE_PORT}/${DATABASE_NAME}?schema=billing
DATABASE_URL_NOTIFICATION=postgresql://${DATABASE_USER}:${DATABASE_PASSWORD}@${DATABASE_HOST}:${DATABASE_PORT}/${DATABASE_NAME}?schema=notification

# ─────────────────────────────────────────────────────────────────────────────
# Redis (Cache & Queues)
# ─────────────────────────────────────────────────────────────────────────────
REDIS_HOST=redis-staging
REDIS_PORT=6379
REDIS_URL=redis://${REDIS_HOST}:${REDIS_PORT}

# ─────────────────────────────────────────────────────────────────────────────
# Security & Authentication
# ─────────────────────────────────────────────────────────────────────────────
# JWT Configuration (RS256 for Staging/Prod)
JWT_ALGORITHM=RS256
# PEM format public/private keys (Generate with openssl)
JWT_PUBLIC_KEY=your_staging_public_key_here
JWT_PRIVATE_KEY=your_staging_private_key_here
# For services that need shared secrets
JWT_SECRET=staging-jwt-secret-do-not-use-in-prod
JWT_EXPIRES_IN=1h
JWT_REFRESH_EXPIRES_IN=7d

# Internal API Communication
INTERNAL_API_KEY=staging-internal-api-key-secret

# CORS Settings
CORS_ORIGINS=http://localhost:4200,http://localhost:4201,https://staging.webrana.com,https://admin.staging.webrana.com

# ─────────────────────────────────────────────────────────────────────────────
# Service Configuration
# ─────────────────────────────────────────────────────────────────────────────

# Rate Limiting (Relaxed for Staging)
RATE_LIMIT_TTL=60
RATE_LIMIT_LIMIT=1000

# DigitalOcean (Staging/Mock)
DIGITALOCEAN_API_TOKEN=staging_do_token
DIGITALOCEAN_DEFAULT_REGION=sgp1
ENCRYPTION_KEY=staging_encryption_key_32_bytes_hex

# Payment Gateway (Tripay Sandbox)
TRIPAY_API_KEY=staging_tripay_key
TRIPAY_PRIVATE_KEY=staging_tripay_private
TRIPAY_MERCHANT_CODE=staging_merchant_code
TRIPAY_MODE=sandbox

# Notification (SMTP/Telegram)
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=staging_user
SMTP_PASS=staging_pass
SMTP_FROM=noreply@staging.webrana.com
TELEGRAM_BOT_TOKEN=staging_telegram_token

# ─────────────────────────────────────────────────────────────────────────────
# Service URLs (Internal Docker Network)
# ─────────────────────────────────────────────────────────────────────────────
API_GATEWAY_URL=http://api-gateway:3000
AUTH_SERVICE_URL=http://auth-service:3001
CATALOG_SERVICE_URL=http://catalog-service:3002
ORDER_SERVICE_URL=http://order-service:3003
BILLING_SERVICE_URL=http://billing-service:3004
INSTANCE_SERVICE_URL=http://instance-service:3005
NOTIFICATION_SERVICE_URL=http://notification-service:3006

# ─────────────────────────────────────────────────────────────────────────────
# Frontend Configuration
# ─────────────────────────────────────────────────────────────────────────────
NEXT_PUBLIC_API_URL=https://api.staging.webrana.com
NEXT_PUBLIC_STRIPE_KEY=pk_test_staging
